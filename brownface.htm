<!DOCTYPE html>
<HTML>
<HEAD>
<TITLE>TSC in the web</TITLE>
<LINK href="nouislider.css" rel="stylesheet"/>
<SCRIPT type="text/javascript" src="nouislider.min.js"></SCRIPT>
<LINK href="dygraph.css" rel="stylesheet"/>
<LINK href="tsc.css" rel="stylesheet"/>
<LINK href="https://fonts.googleapis.com/css?family=Barlow+Condensed|Raleway" rel="stylesheet">
<SCRIPT type="text/javascript" src="dygraph.min.js"></SCRIPT>
<SCRIPT type="text/javascript" src="tsc_common.js"></SCRIPT>

<STYLE>
#range_RB,
#range_RT,
#range_RM,
#range_RV {
    width: 300px;
    margin: 0 auto 0px;
    display: inline-block;
}
#value_RB,
#value_RT,
#value_RM,
#value_RV {
    width: 70px;
    display: inline-block;
    text-align: center;
    margin: 0;
}
#label_RB,
#label_RT,
#label_RM,
#label_RV {
    width: 150px;
    display: inline-block;
    text-align: center;
    margin: 0;
}
</STYLE>

</HEAD>
<BODY>
<FORM name="frm">
  <TABLE align="center">
    <TR>
      <TD colspan="3" align="left" class="navbar">
        <DIV id="linkDiv" style="float: left;" class="navbar-stack"></DIV>
        <DIV id="infoDiv" style="float: right;" class="navbar-info"><a href="info.htm" class="navbar-menu-item">INFO</a></DIV>
      </TD>
    </TR>
    <TR>
      <TD align="center" valign="top" width="400" class="tonestack-image">
        <IMG src="brownface2_pic.png"></IMG>
      </TD>
      <TD align="right" valign="top" width="180" class="tonestack-values">
        <table class="tonestack-values-table">
                <thead>
                    <tr>
                        <th class="tonestack-value-th-part">Part</th>
                        <th class="tonestack-value-th-value">Value</th>
                        <th class="tonestack-value-th-unit"></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="tonestack-value-label">RIN</td>
                        <td class="tonestack-value-value"><INPUT type="text" name="RIN" id="id_RIN" size="7" readonly="readonly" style="text-align: right" class="tonestack-value-input"></td>
                        <td class="tonestack-value-unit">&Omega;</td>
                    </tr>
                    <tr>
                        <td class="tonestack-value-label">RT</td>
                        <td class="tonestack-value-value"><INPUT type="text" name="RT" id="id_RT" size="7" readonly="readonly" style="text-align: right" class="tonestack-value-input"></td>
                        <td class="tonestack-value-unit">&Omega;</td>
                    </tr>
                    <tr>
                        <td class="tonestack-value-label">RB</td>
                        <td class="tonestack-value-value"><INPUT type="text" name="RB" id="id_RB" size="7" readonly="readonly" style="text-align: right" class="tonestack-value-input"></td>
                        <td class="tonestack-value-unit">&Omega;</td>
                    </tr>
                    <tr>
                        <td class="tonestack-value-label">RTap</td>
                        <td class="tonestack-value-value"><INPUT type="text" name="RTap" id="id_RTap" size="7" readonly="readonly" style="text-align: right" class="tonestack-value-input"></td>
                        <td class="tonestack-value-unit">&Omega;</td>
                    </tr>
                    <tr>
                        <td class="tonestack-value-label">R1</td>
                        <td class="tonestack-value-value"><INPUT type="text" name="R1" id="id_R1" size="7" readonly="readonly" style="text-align: right" class="tonestack-value-input"></td>
                        <td class="tonestack-value-unit">&Omega;</td>
                    </tr>
                    <tr>
                        <td class="tonestack-value-label">R2</td>
                        <td class="tonestack-value-value"><INPUT type="text" name="R2" id="id_R2" size="7" readonly="readonly" style="text-align: right" class="tonestack-value-input"></td>
                        <td class="tonestack-value-unit">&Omega;</td>
                    </tr>
                    <tr>
                        <td class="tonestack-value-label">RL</td>
                        <td class="tonestack-value-value"><INPUT type="text" name="RL" id="id_RL" size="7" readonly="readonly" style="text-align: right" class="tonestack-value-input"></td>
                        <td class="tonestack-value-unit">&Omega;</td>
                    </tr>
                    <tr>
                        <td class="tonestack-value-label">C1</td>
                        <td class="tonestack-value-value"><INPUT type="text" name="C1" id="id_C1" size="7" readonly="readonly" style="text-align: right" class="tonestack-value-input"></td>
                        <td class="tonestack-value-unit">pF</td>
                    </tr>
                    <tr>
                        <td class="tonestack-value-label">C2</td>
                        <td class="tonestack-value-value"><INPUT type="text" name="C2" id="id_C2" size="7" readonly="readonly" style="text-align: right" class="tonestack-value-input"></td>
                        <td class="tonestack-value-unit">pF</td>
                    </tr>
                    <tr>
                        <td class="tonestack-value-label">C3</td>
                        <td class="tonestack-value-value"><INPUT type="text" name="C3" id="id_C3" size="7" readonly="readonly" style="text-align: right" class="tonestack-value-input"></td>
                        <td class="tonestack-value-unit">pF</td>
                    </tr>
                    <tr>
                        <td class="tonestack-value-label">C4</td>
                        <td class="tonestack-value-value"><INPUT type="text" name="C4" id="id_C4" size="7" readonly="readonly" style="text-align: right" class="tonestack-value-input"></td>
                        <td class="tonestack-value-unit">pF</td>
                    </tr>
                </tbody>

        </table>
        <CENTER>
        <INPUT type="button" name="edit" value="Edit" title="Edit values" id="id_edit" onclick="editValues();" class="tonestack-values-button">
        <INPUT type="button" name="apply" value="Apply" title="Apply values" id="id_apply" onclick="applyValues();" class="tonestack-values-button">
        <INPUT type="button" name="defaults" value="Default" title="Set default values" id="id_defaults" onclick="setDefaultValues();" class="tonestack-values-button">
        </CENTER>
      </TD>  
      <TD rowspan="2" align="center" valign="top" width="700" class="tonestack-graph">
        <div id="buttonContainer">
            <INPUT type="button" name="Clear" value="Clear snapshots" id="id_clear" onclick="clearSnapshots();" class="tonestack-values-button" style="float: right;"> &nbsp;
            <INPUT type="button" name="Snapshot" value="Take snapshot" id="id_snapshot" onclick="addSeries();" class="tonestack-values-button" style="float: right;"> &nbsp;
            <INPUT type="button" name="Sweep" value="Sweep" id="id_sweep" onclick="sweepValues();" class="tonestack-values-button" style="float: right;">
        </div>
        <div id="graphContainer" class="tonestack-graph-container">
            <DIV id="graph" style="height: 480px; width: 640px;"></DIV>
            <DIV id="legendDiv" class="tonestack-graph-value"></DIV>
       </div>
      </TD>
    </TR>
    <TR>
      <TD colspan="2" class="tonestack-sliders">
        <BR>
        <SPAN id="label_RB" class="tonestack-slider-label">RB <select id="id_RB_pot" name="RB_pot" class="tonestack-select-pot" onchange="doCalc()">
                                                              <option value="Linear">Linear</option>
                                                              <option value="LogA" selected="selected">LogA</option>
                                                              <option value="LogB">LogB</option></select> 
        </SPAN>
        <DIV id="range_RB" class="tonestack-slider-input"></DIV>
        <SPAN id="value_RB" class="tonestack-slider-value"></SPAN><BR><BR><BR><BR>
        <SPAN id="label_RT" class="tonestack-slider-label">RT <select id="id_RT_pot" name="RT_pot" class="tonestack-select-pot" onchange="doCalc()">
                                                              <option value="Linear">Linear</option>
                                                              <option value="LogA" selected="selected">LogA</option>
                                                              <option value="LogB">LogB</option></select> 
        </SPAN>
        <DIV id="range_RT" class="tonestack-slider-input"></DIV>
        <SPAN id="value_RT" class="tonestack-slider-value"></SPAN><BR><BR><BR><BR>
      </TD>
    </TR>
  </TABLE>

<SCRIPT>
    // create links to all the tone stack pages to the top of the page 
    createLinks("linkDiv","Brownface");

    // define component variables for calculation
    var RTreble;
    var RBass;
    var RTap;
    var RIN;
    var R1;
    var R2;
    var RL;
    var C1;
    var C2;
    var C3;
    var C4;
    var CIN = 0;

    var data = [];

    // create sliders and save the div-element of the slider
    var range_RB = createSlider('range_RB','value_RB');
    var range_RT = createSlider('range_RT','value_RT');

    // variable g will hold the graph object for synchronized updates
    var g = null;

    // data for frequency points is created here and saved to array X
    X = createFrequencies(90,10,100000,1);

    // set the default values to the component variables and input fields
    setDefaultValues();

    // start listening the onSlide event from the slider and run the analysis function
    range_RB.noUiSlider.on('slide', doCalc);
    range_RT.noUiSlider.on('slide', doCalc);

    // this function is called when the Apply-button is clicked
    function applyValues() {
        RIN     = parseInt(document.frm.RIN.value);
        RBass   = parseInt(document.frm.RB.value);
        RTreble = parseInt(document.frm.RT.value);
        RTap    = parseInt(document.frm.RTap.value);
        R1      = parseInt(document.frm.R1.value);
        R2      = parseInt(document.frm.R2.value);
        RL      = parseInt(document.frm.RL.value);
        C1     = (1e-12)*parseInt(document.frm.C1.value);
        C2     = (1e-12)*parseInt(document.frm.C2.value);
        C3     = (1e-12)*parseInt(document.frm.C3.value);
        C4     = (1e-12)*parseInt(document.frm.C4.value);
        //CIN     = (1e-12)*parseInt(document.frm.CIN.value);

        // set the input fields to readonly mode with gray background
        var inputElements = document.forms["frm"].getElementsByTagName('input');
        for (var i in inputElements) {
            if (inputElements[i].type == "text") {
                inputElements[i].setAttribute('readonly', 'readonly');
                inputElements[i].style.backgroundColor = "#EBEBE4";
            }
        }
        doCalc();
    }


    // this function is called when the Edit-button is clicked
    function editValues() {
        var inputElements = document.forms["frm"].getElementsByTagName('input');
        for (var i in inputElements) {
            if (inputElements[i].type == "text") {
                inputElements[i].removeAttribute('readonly');
                inputElements[i].style.backgroundColor = "#FFFFFF";
            }
        }
    }


    // This function is called when the Set default values -button is clicked.
    // It sets the hard-coded values to the input fields and applies the values.
    function setDefaultValues() {
        document.frm.RIN.value  = 38000;
        document.frm.RT.value   = 350000;
        document.frm.RB.value   = 250000;
        document.frm.RTap.value = 70000;
        document.frm.R1.value   = 100000;
        document.frm.R2.value   = 6800;
        document.frm.RL.value   = 1000000;
        document.frm.C1.value   = 250;
        document.frm.C2.value   = 100000;
        document.frm.C3.value   = 100000;
        document.frm.C4.value   = 5000;
        //document.frm.CIN.value  = 0;
        
        applyValues();
    }
    
    
    // creates a sweep plot with max and mid values
    // prints amplitude data to console for testing
    // against model validity. Use "store as global variable"
    // in Firefox for all arrays and then ''+temp8;
    // This function creates the sweep for extreme values
    // and produces data for testing the accuracy of the model
    function sweepValues() {
        for (p = 0; p <= 10; p += 5) {
            range_RB.noUiSlider.set(p);
            for (q = 0; q <=10; q += 5) {
                range_RT.noUiSlider.set(q);
                doCalc();
                console.log(data);
                addSeries();
            }
        }
    }


    // This function is called with every change of the slider.
    // It does the hard math and evaluates the filter transfer function
    // for the given frequency range and updates values to the graph.
    function doCalc() {
        var row = [];
        data = [];

        // pot rotation 0 - 10 from the slider component
        var RotTreble = getRotationForPotType(range_RT.noUiSlider.get(), document.frm.RT_pot.value);
        var RotBass   = getRotationForPotType(range_RB.noUiSlider.get(), document.frm.RB_pot.value);

        var RtapAbove = RTreble - RTap;
        var RtapBelow = RTap;
        var belowTap = false;

        var RTx  = Math.round( RTreble*(1.0*RotTreble/10.0) );
        if (RTx >= RtapBelow)  {
            RT12 = RTx - RtapBelow;
            RT11 = RTreble - RTx;
            RT21 = RT22 = RtapBelow/2;
        } else {
            RT21 = RtapBelow - RTx;
            RT22 = RTx;
            RT11 = RT12 = RtapAbove/2;
            belowTap = true;
        }

        var RB   = Math.round( RBass*(1.0*RotBass/10.0) );


if (belowTap) {
var DEN_ZRe = 0

var DEN_YIm = C1*C2*C3*C4*CIN*R2*RB*RIN*RT12*RT21*RT22
 + C1*C2*C3*C4*CIN*R1*RB*RIN*RT12*RT21*RT22
 + C1*C2*C3*C4*CIN*R2*RB*RIN*RT11*RT21*RT22
 + C1*C2*C3*C4*CIN*R1*RB*RIN*RT11*RT21*RT22
 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RT21*RT22
 + C1*C2*C3*C4*CIN*R2*RB*RIN*RL*RT12*RT22
 + C1*C2*C3*C4*CIN*R1*RB*RIN*RL*RT12*RT22
 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RT12*RT22
 + C1*C2*C3*C4*CIN*R2*RB*RIN*RL*RT11*RT22
 + C1*C2*C3*C4*CIN*R1*RB*RIN*RL*RT11*RT22
 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RT11*RT22
 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RL*RT22
 + C1*C2*C3*C4*CIN*R2*RB*RIN*RL*RT12*RT21
 + C1*C2*C3*C4*CIN*R1*RB*RIN*RL*RT12*RT21
 + C1*C2*C3*C4*CIN*R2*RB*RIN*RL*RT11*RT21
 + C1*C2*C3*C4*CIN*R1*RB*RIN*RL*RT11*RT21
 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RL*RT21 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RL*RT12
 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RL*RT11;

var DEN_XRe = C1*C2*C4*CIN*RB*RIN*RT12*RT21*RT22 + C1*C2*C3*C4*RB*RIN*RT12*RT21*RT22
 + C1*C3*C4*CIN*R2*RIN*RT12*RT21*RT22 + C1*C2*C4*CIN*R2*RIN*RT12*RT21*RT22
 + C1*C3*C4*CIN*R1*RIN*RT12*RT21*RT22 + C1*C2*C4*CIN*R1*RIN*RT12*RT21*RT22
 + C1*C2*C3*C4*R2*RB*RT12*RT21*RT22 + C1*C2*C3*C4*R1*RB*RT12*RT21*RT22
 + C1*C2*C4*CIN*RB*RIN*RT11*RT21*RT22 + C1*C2*C3*C4*RB*RIN*RT11*RT21*RT22
 + C1*C3*C4*CIN*R2*RIN*RT11*RT21*RT22 + C1*C2*C4*CIN*R2*RIN*RT11*RT21*RT22
 + C1*C3*C4*CIN*R1*RIN*RT11*RT21*RT22 + C1*C2*C4*CIN*R1*RIN*RT11*RT21*RT22
 + C1*C2*C3*C4*R2*RB*RT11*RT21*RT22 + C1*C2*C3*C4*R1*RB*RT11*RT21*RT22
 + C2*C3*C4*CIN*R2*RB*RIN*RT21*RT22 + C1*C3*C4*CIN*R2*RB*RIN*RT21*RT22
 + C2*C3*C4*CIN*R1*RB*RIN*RT21*RT22 + C1*C3*C4*CIN*R1*RB*RIN*RT21*RT22
 + C1*C2*C4*CIN*R1*RB*RIN*RT21*RT22 + C1*C2*C3*C4*R1*RB*RIN*RT21*RT22
 + C1*C3*C4*CIN*R1*R2*RIN*RT21*RT22 + C1*C2*C4*CIN*R1*R2*RIN*RT21*RT22
 + C1*C2*C3*C4*R1*R2*RB*RT21*RT22 + C1*C2*C4*CIN*RB*RIN*RL*RT12*RT22
 + C1*C2*C3*C4*RB*RIN*RL*RT12*RT22 + C1*C3*C4*CIN*R2*RIN*RL*RT12*RT22
 + C1*C2*C4*CIN*R2*RIN*RL*RT12*RT22 + C1*C3*C4*CIN*R1*RIN*RL*RT12*RT22
 + C1*C2*C4*CIN*R1*RIN*RL*RT12*RT22 + C1*C2*C3*C4*R2*RB*RL*RT12*RT22
 + C1*C2*C3*C4*R1*RB*RL*RT12*RT22 + C1*C3*C4*CIN*R2*RB*RIN*RT12*RT22
 + C1*C2*C3*C4*R2*RB*RIN*RT12*RT22 + C1*C3*C4*CIN*R1*RB*RIN*RT12*RT22
 + C1*C2*C4*CIN*R1*RB*RIN*RT12*RT22 + C1*C3*C4*CIN*R1*R2*RIN*RT12*RT22
 + C1*C2*C4*CIN*R1*R2*RIN*RT12*RT22 + C1*C2*C3*C4*R1*R2*RB*RT12*RT22
 + C1*C2*C4*CIN*RB*RIN*RL*RT11*RT22 + C1*C2*C3*C4*RB*RIN*RL*RT11*RT22
 + C1*C3*C4*CIN*R2*RIN*RL*RT11*RT22 + C1*C2*C4*CIN*R2*RIN*RL*RT11*RT22
 + C1*C3*C4*CIN*R1*RIN*RL*RT11*RT22 + C1*C2*C4*CIN*R1*RIN*RL*RT11*RT22
 + C1*C2*C3*C4*R2*RB*RL*RT11*RT22 + C1*C2*C3*C4*R1*RB*RL*RT11*RT22
 + C1*C3*C4*CIN*R2*RB*RIN*RT11*RT22 + C1*C2*C3*C4*R2*RB*RIN*RT11*RT22
 + C1*C3*C4*CIN*R1*RB*RIN*RT11*RT22 + C1*C2*C4*CIN*R1*RB*RIN*RT11*RT22
 + C1*C3*C4*CIN*R1*R2*RIN*RT11*RT22 + C1*C2*C4*CIN*R1*R2*RIN*RT11*RT22
 + C1*C2*C3*C4*R1*R2*RB*RT11*RT22 + C2*C3*C4*CIN*R2*RB*RIN*RL*RT22
 + C1*C3*C4*CIN*R2*RB*RIN*RL*RT22 + C2*C3*C4*CIN*R1*RB*RIN*RL*RT22
 + C1*C3*C4*CIN*R1*RB*RIN*RL*RT22 + C1*C2*C4*CIN*R1*RB*RIN*RL*RT22
 + C1*C2*C3*C4*R1*RB*RIN*RL*RT22 + C1*C3*C4*CIN*R1*R2*RIN*RL*RT22
 + C1*C2*C4*CIN*R1*R2*RIN*RL*RT22 + C1*C2*C3*C4*R1*R2*RB*RL*RT22
 + C2*C3*C4*CIN*R1*R2*RB*RIN*RT22 + C1*C2*C3*C4*R1*R2*RB*RIN*RT22
 + C1*C2*C4*CIN*RB*RIN*RL*RT12*RT21 + C1*C2*C3*C4*RB*RIN*RL*RT12*RT21
 + C1*C3*C4*CIN*R2*RIN*RL*RT12*RT21 + C1*C2*C4*CIN*R2*RIN*RL*RT12*RT21
 + C1*C3*C4*CIN*R1*RIN*RL*RT12*RT21 + C1*C2*C4*CIN*R1*RIN*RL*RT12*RT21
 + C1*C2*C3*C4*R2*RB*RL*RT12*RT21 + C1*C2*C3*C4*R1*RB*RL*RT12*RT21
 + C1*C2*C3*CIN*R2*RB*RIN*RT12*RT21 + C1*C2*C3*CIN*R1*RB*RIN*RT12*RT21
 + C1*C2*C4*CIN*RB*RIN*RL*RT11*RT21 + C1*C2*C3*C4*RB*RIN*RL*RT11*RT21
 + C1*C3*C4*CIN*R2*RIN*RL*RT11*RT21 + C1*C2*C4*CIN*R2*RIN*RL*RT11*RT21
 + C1*C3*C4*CIN*R1*RIN*RL*RT11*RT21 + C1*C2*C4*CIN*R1*RIN*RL*RT11*RT21
 + C1*C2*C3*C4*R2*RB*RL*RT11*RT21 + C1*C2*C3*C4*R1*RB*RL*RT11*RT21
 + C1*C2*C3*CIN*R2*RB*RIN*RT11*RT21 + C1*C2*C3*CIN*R1*RB*RIN*RT11*RT21
 + C2*C3*C4*CIN*R2*RB*RIN*RL*RT21 + C1*C3*C4*CIN*R2*RB*RIN*RL*RT21
 + C2*C3*C4*CIN*R1*RB*RIN*RL*RT21 + C1*C3*C4*CIN*R1*RB*RIN*RL*RT21
 + C1*C2*C4*CIN*R1*RB*RIN*RL*RT21 + C1*C2*C3*C4*R1*RB*RIN*RL*RT21
 + C1*C3*C4*CIN*R1*R2*RIN*RL*RT21 + C1*C2*C4*CIN*R1*R2*RIN*RL*RT21
 + C1*C2*C3*C4*R1*R2*RB*RL*RT21 + C1*C2*C3*CIN*R1*R2*RB*RIN*RT21
 + C1*C3*C4*CIN*R2*RB*RIN*RL*RT12 + C1*C2*C3*CIN*R2*RB*RIN*RL*RT12
 + C1*C2*C3*C4*R2*RB*RIN*RL*RT12 + C1*C3*C4*CIN*R1*RB*RIN*RL*RT12
 + C1*C2*C4*CIN*R1*RB*RIN*RL*RT12 + C1*C2*C3*CIN*R1*RB*RIN*RL*RT12
 + C1*C3*C4*CIN*R1*R2*RIN*RL*RT12 + C1*C2*C4*CIN*R1*R2*RIN*RL*RT12
 + C1*C2*C3*C4*R1*R2*RB*RL*RT12 + C1*C2*C3*CIN*R1*R2*RB*RIN*RT12
 + C1*C3*C4*CIN*R2*RB*RIN*RL*RT11 + C1*C2*C3*CIN*R2*RB*RIN*RL*RT11
 + C1*C2*C3*C4*R2*RB*RIN*RL*RT11 + C1*C3*C4*CIN*R1*RB*RIN*RL*RT11
 + C1*C2*C4*CIN*R1*RB*RIN*RL*RT11 + C1*C2*C3*CIN*R1*RB*RIN*RL*RT11
 + C1*C3*C4*CIN*R1*R2*RIN*RL*RT11 + C1*C2*C4*CIN*R1*R2*RIN*RL*RT11
 + C1*C2*C3*C4*R1*R2*RB*RL*RT11 + C1*C2*C3*CIN*R1*R2*RB*RIN*RT11
 + C2*C3*C4*CIN*R1*R2*RB*RIN*RL + C1*C2*C3*CIN*R1*R2*RB*RIN*RL
 + C1*C2*C3*C4*R1*R2*RB*RIN*RL;

var DEN_AIm = C1*C4*CIN*RIN*RT12*RT21*RT22 + C1*C3*C4*RIN*RT12*RT21*RT22
 + C1*C2*C4*RIN*RT12*RT21*RT22 + C1*C2*C4*RB*RT12*RT21*RT22
 + C1*C3*C4*R2*RT12*RT21*RT22 + C1*C2*C4*R2*RT12*RT21*RT22
 + C1*C3*C4*R1*RT12*RT21*RT22 + C1*C2*C4*R1*RT12*RT21*RT22
 + C1*C4*CIN*RIN*RT11*RT21*RT22 + C1*C3*C4*RIN*RT11*RT21*RT22
 + C1*C2*C4*RIN*RT11*RT21*RT22 + C1*C2*C4*RB*RT11*RT21*RT22
 + C1*C3*C4*R2*RT11*RT21*RT22 + C1*C2*C4*R2*RT11*RT21*RT22
 + C1*C3*C4*R1*RT11*RT21*RT22 + C1*C2*C4*R1*RT11*RT21*RT22
 + C2*C4*CIN*RB*RIN*RT21*RT22 + C1*C4*CIN*RB*RIN*RT21*RT22
 + C2*C3*C4*RB*RIN*RT21*RT22 + C1*C3*C4*RB*RIN*RT21*RT22
 + C3*C4*CIN*R2*RIN*RT21*RT22 + C2*C4*CIN*R2*RIN*RT21*RT22
 + C1*C4*CIN*R2*RIN*RT21*RT22 + C3*C4*CIN*R1*RIN*RT21*RT22
 + C2*C4*CIN*R1*RIN*RT21*RT22 + C1*C3*C4*R1*RIN*RT21*RT22
 + C1*C2*C4*R1*RIN*RT21*RT22 + C2*C3*C4*R2*RB*RT21*RT22
 + C1*C3*C4*R2*RB*RT21*RT22 + C2*C3*C4*R1*RB*RT21*RT22
 + C1*C3*C4*R1*RB*RT21*RT22 + C1*C2*C4*R1*RB*RT21*RT22
 + C1*C3*C4*R1*R2*RT21*RT22 + C1*C2*C4*R1*R2*RT21*RT22
 + C1*C4*CIN*RIN*RL*RT12*RT22 + C1*C3*C4*RIN*RL*RT12*RT22
 + C1*C2*C4*RIN*RL*RT12*RT22 + C1*C2*C4*RB*RL*RT12*RT22
 + C1*C3*C4*R2*RL*RT12*RT22 + C1*C2*C4*R2*RL*RT12*RT22
 + C1*C3*C4*R1*RL*RT12*RT22 + C1*C2*C4*R1*RL*RT12*RT22
 + C1*C4*CIN*RB*RIN*RT12*RT22 + C1*C3*C4*RB*RIN*RT12*RT22
 + C1*C2*C4*RB*RIN*RT12*RT22 + C1*C4*CIN*R2*RIN*RT12*RT22
 + C1*C3*C4*R2*RIN*RT12*RT22 + C1*C2*C4*R2*RIN*RT12*RT22
 + C1*C3*C4*R2*RB*RT12*RT22 + C1*C3*C4*R1*RB*RT12*RT22
 + C1*C2*C4*R1*RB*RT12*RT22 + C1*C3*C4*R1*R2*RT12*RT22
 + C1*C2*C4*R1*R2*RT12*RT22 + C1*C4*CIN*RIN*RL*RT11*RT22
 + C1*C3*C4*RIN*RL*RT11*RT22 + C1*C2*C4*RIN*RL*RT11*RT22
 + C1*C2*C4*RB*RL*RT11*RT22 + C1*C3*C4*R2*RL*RT11*RT22
 + C1*C2*C4*R2*RL*RT11*RT22 + C1*C3*C4*R1*RL*RT11*RT22
 + C1*C2*C4*R1*RL*RT11*RT22 + C1*C4*CIN*RB*RIN*RT11*RT22
 + C1*C3*C4*RB*RIN*RT11*RT22 + C1*C2*C4*RB*RIN*RT11*RT22
 + C1*C4*CIN*R2*RIN*RT11*RT22 + C1*C3*C4*R2*RIN*RT11*RT22
 + C1*C2*C4*R2*RIN*RT11*RT22 + C1*C3*C4*R2*RB*RT11*RT22
 + C1*C3*C4*R1*RB*RT11*RT22 + C1*C2*C4*R1*RB*RT11*RT22
 + C1*C3*C4*R1*R2*RT11*RT22 + C1*C2*C4*R1*R2*RT11*RT22
 + C2*C4*CIN*RB*RIN*RL*RT22 + C1*C4*CIN*RB*RIN*RL*RT22
 + C2*C3*C4*RB*RIN*RL*RT22 + C1*C3*C4*RB*RIN*RL*RT22 + C3*C4*CIN*R2*RIN*RL*RT22
 + C2*C4*CIN*R2*RIN*RL*RT22 + C1*C4*CIN*R2*RIN*RL*RT22
 + C3*C4*CIN*R1*RIN*RL*RT22 + C2*C4*CIN*R1*RIN*RL*RT22
 + C1*C3*C4*R1*RIN*RL*RT22 + C1*C2*C4*R1*RIN*RL*RT22 + C2*C3*C4*R2*RB*RL*RT22
 + C1*C3*C4*R2*RB*RL*RT22 + C2*C3*C4*R1*RB*RL*RT22 + C1*C3*C4*R1*RB*RL*RT22
 + C1*C2*C4*R1*RB*RL*RT22 + C1*C3*C4*R1*R2*RL*RT22 + C1*C2*C4*R1*R2*RL*RT22
 + C3*C4*CIN*R2*RB*RIN*RT22 + C2*C3*C4*R2*RB*RIN*RT22 + C1*C3*C4*R2*RB*RIN*RT22
 + C3*C4*CIN*R1*RB*RIN*RT22 + C2*C4*CIN*R1*RB*RIN*RT22
 + C1*C3*C4*R1*RB*RIN*RT22 + C1*C2*C4*R1*RB*RIN*RT22 + C3*C4*CIN*R1*R2*RIN*RT22
 + C2*C4*CIN*R1*R2*RIN*RT22 + C1*C3*C4*R1*R2*RIN*RT22 + C1*C2*C4*R1*R2*RIN*RT22
 + C2*C3*C4*R1*R2*RB*RT22 + C1*C4*CIN*RIN*RL*RT12*RT21
 + C1*C3*C4*RIN*RL*RT12*RT21 + C1*C2*C4*RIN*RL*RT12*RT21
 + C1*C2*C4*RB*RL*RT12*RT21 + C1*C3*C4*R2*RL*RT12*RT21
 + C1*C2*C4*R2*RL*RT12*RT21 + C1*C3*C4*R1*RL*RT12*RT21
 + C1*C2*C4*R1*RL*RT12*RT21 + C1*C2*CIN*RB*RIN*RT12*RT21
 + C1*C2*C3*RB*RIN*RT12*RT21 + C1*C3*CIN*R2*RIN*RT12*RT21
 + C1*C2*CIN*R2*RIN*RT12*RT21 + C1*C3*CIN*R1*RIN*RT12*RT21
 + C1*C2*CIN*R1*RIN*RT12*RT21 + C1*C2*C3*R2*RB*RT12*RT21
 + C1*C2*C3*R1*RB*RT12*RT21 + C1*C4*CIN*RIN*RL*RT11*RT21
 + C1*C3*C4*RIN*RL*RT11*RT21 + C1*C2*C4*RIN*RL*RT11*RT21
 + C1*C2*C4*RB*RL*RT11*RT21 + C1*C3*C4*R2*RL*RT11*RT21
 + C1*C2*C4*R2*RL*RT11*RT21 + C1*C3*C4*R1*RL*RT11*RT21
 + C1*C2*C4*R1*RL*RT11*RT21 + C1*C2*CIN*RB*RIN*RT11*RT21
 + C1*C2*C3*RB*RIN*RT11*RT21 + C1*C3*CIN*R2*RIN*RT11*RT21
 + C1*C2*CIN*R2*RIN*RT11*RT21 + C1*C3*CIN*R1*RIN*RT11*RT21
 + C1*C2*CIN*R1*RIN*RT11*RT21 + C1*C2*C3*R2*RB*RT11*RT21
 + C1*C2*C3*R1*RB*RT11*RT21 + C2*C4*CIN*RB*RIN*RL*RT21
 + C1*C4*CIN*RB*RIN*RL*RT21 + C2*C3*C4*RB*RIN*RL*RT21 + C1*C3*C4*RB*RIN*RL*RT21
 + C3*C4*CIN*R2*RIN*RL*RT21 + C2*C4*CIN*R2*RIN*RL*RT21
 + C1*C4*CIN*R2*RIN*RL*RT21 + C3*C4*CIN*R1*RIN*RL*RT21
 + C2*C4*CIN*R1*RIN*RL*RT21 + C1*C3*C4*R1*RIN*RL*RT21 + C1*C2*C4*R1*RIN*RL*RT21
 + C2*C3*C4*R2*RB*RL*RT21 + C1*C3*C4*R2*RB*RL*RT21 + C2*C3*C4*R1*RB*RL*RT21
 + C1*C3*C4*R1*RB*RL*RT21 + C1*C2*C4*R1*RB*RL*RT21 + C1*C3*C4*R1*R2*RL*RT21
 + C1*C2*C4*R1*R2*RL*RT21 + C2*C3*CIN*R2*RB*RIN*RT21 + C1*C3*CIN*R2*RB*RIN*RT21
 + C2*C3*CIN*R1*RB*RIN*RT21 + C1*C3*CIN*R1*RB*RIN*RT21
 + C1*C2*CIN*R1*RB*RIN*RT21 + C1*C2*C3*R1*RB*RIN*RT21
 + C1*C3*CIN*R1*R2*RIN*RT21 + C1*C2*CIN*R1*R2*RIN*RT21 + C1*C2*C3*R1*R2*RB*RT21
 + C1*C4*CIN*RB*RIN*RL*RT12 + C1*C2*CIN*RB*RIN*RL*RT12
 + C1*C3*C4*RB*RIN*RL*RT12 + C1*C2*C4*RB*RIN*RL*RT12 + C1*C2*C3*RB*RIN*RL*RT12
 + C1*C4*CIN*R2*RIN*RL*RT12 + C1*C3*CIN*R2*RIN*RL*RT12
 + C1*C2*CIN*R2*RIN*RL*RT12 + C1*C3*C4*R2*RIN*RL*RT12 + C1*C2*C4*R2*RIN*RL*RT12
 + C1*C3*CIN*R1*RIN*RL*RT12 + C1*C2*CIN*R1*RIN*RL*RT12 + C1*C3*C4*R2*RB*RL*RT12
 + C1*C2*C3*R2*RB*RL*RT12 + C1*C3*C4*R1*RB*RL*RT12 + C1*C2*C4*R1*RB*RL*RT12
 + C1*C2*C3*R1*RB*RL*RT12 + C1*C3*C4*R1*R2*RL*RT12 + C1*C2*C4*R1*R2*RL*RT12
 + C1*C3*CIN*R2*RB*RIN*RT12 + C1*C2*C3*R2*RB*RIN*RT12
 + C1*C3*CIN*R1*RB*RIN*RT12 + C1*C2*CIN*R1*RB*RIN*RT12
 + C1*C3*CIN*R1*R2*RIN*RT12 + C1*C2*CIN*R1*R2*RIN*RT12 + C1*C2*C3*R1*R2*RB*RT12
 + C1*C4*CIN*RB*RIN*RL*RT11 + C1*C2*CIN*RB*RIN*RL*RT11
 + C1*C3*C4*RB*RIN*RL*RT11 + C1*C2*C4*RB*RIN*RL*RT11 + C1*C2*C3*RB*RIN*RL*RT11
 + C1*C4*CIN*R2*RIN*RL*RT11 + C1*C3*CIN*R2*RIN*RL*RT11
 + C1*C2*CIN*R2*RIN*RL*RT11 + C1*C3*C4*R2*RIN*RL*RT11 + C1*C2*C4*R2*RIN*RL*RT11
 + C1*C3*CIN*R1*RIN*RL*RT11 + C1*C2*CIN*R1*RIN*RL*RT11 + C1*C3*C4*R2*RB*RL*RT11
 + C1*C2*C3*R2*RB*RL*RT11 + C1*C3*C4*R1*RB*RL*RT11 + C1*C2*C4*R1*RB*RL*RT11
 + C1*C2*C3*R1*RB*RL*RT11 + C1*C3*C4*R1*R2*RL*RT11 + C1*C2*C4*R1*R2*RL*RT11
 + C1*C3*CIN*R2*RB*RIN*RT11 + C1*C2*C3*R2*RB*RIN*RT11
 + C1*C3*CIN*R1*RB*RIN*RT11 + C1*C2*CIN*R1*RB*RIN*RT11
 + C1*C3*CIN*R1*R2*RIN*RT11 + C1*C2*CIN*R1*R2*RIN*RT11 + C1*C2*C3*R1*R2*RB*RT11
 + C3*C4*CIN*R2*RB*RIN*RL + C2*C3*CIN*R2*RB*RIN*RL + C1*C3*CIN*R2*RB*RIN*RL
 + C2*C3*C4*R2*RB*RIN*RL + C1*C3*C4*R2*RB*RIN*RL + C3*C4*CIN*R1*RB*RIN*RL
 + C2*C4*CIN*R1*RB*RIN*RL + C2*C3*CIN*R1*RB*RIN*RL + C1*C3*CIN*R1*RB*RIN*RL
 + C1*C2*CIN*R1*RB*RIN*RL + C1*C3*C4*R1*RB*RIN*RL + C1*C2*C4*R1*RB*RIN*RL
 + C1*C2*C3*R1*RB*RIN*RL + C3*C4*CIN*R1*R2*RIN*RL + C2*C4*CIN*R1*R2*RIN*RL
 + C1*C3*CIN*R1*R2*RIN*RL + C1*C2*CIN*R1*R2*RIN*RL + C1*C3*C4*R1*R2*RIN*RL
 + C1*C2*C4*R1*R2*RIN*RL + C2*C3*C4*R1*R2*RB*RL + C1*C2*C3*R1*R2*RB*RL
 + C2*C3*CIN*R1*R2*RB*RIN + C1*C2*C3*R1*R2*RB*RIN;

var DEN_BRe = C1*C4*RT12*RT21*RT22 + C1*C4*RT11*RT21*RT22 + C4*CIN*RIN*RT21*RT22
 + C3*C4*RIN*RT21*RT22 + C2*C4*RIN*RT21*RT22 + C1*C4*RIN*RT21*RT22
 + C2*C4*RB*RT21*RT22 + C1*C4*RB*RT21*RT22 + C3*C4*R2*RT21*RT22
 + C2*C4*R2*RT21*RT22 + C1*C4*R2*RT21*RT22 + C3*C4*R1*RT21*RT22
 + C2*C4*R1*RT21*RT22 + C1*C4*RL*RT12*RT22 + C1*C4*RB*RT12*RT22
 + C1*C4*R2*RT12*RT22 + C1*C4*RL*RT11*RT22 + C1*C4*RB*RT11*RT22
 + C1*C4*R2*RT11*RT22 + C4*CIN*RIN*RL*RT22 + C3*C4*RIN*RL*RT22
 + C2*C4*RIN*RL*RT22 + C1*C4*RIN*RL*RT22 + C2*C4*RB*RL*RT22 + C1*C4*RB*RL*RT22
 + C3*C4*R2*RL*RT22 + C2*C4*R2*RL*RT22 + C1*C4*R2*RL*RT22 + C3*C4*R1*RL*RT22
 + C2*C4*R1*RL*RT22 + C4*CIN*RB*RIN*RT22 + C3*C4*RB*RIN*RT22
 + C2*C4*RB*RIN*RT22 + C1*C4*RB*RIN*RT22 + C4*CIN*R2*RIN*RT22
 + C3*C4*R2*RIN*RT22 + C2*C4*R2*RIN*RT22 + C1*C4*R2*RIN*RT22 + C3*C4*R2*RB*RT22
 + C3*C4*R1*RB*RT22 + C2*C4*R1*RB*RT22 + C3*C4*R1*R2*RT22 + C2*C4*R1*R2*RT22
 + C1*C4*RL*RT12*RT21 + C1*CIN*RIN*RT12*RT21 + C1*C3*RIN*RT12*RT21
 + C1*C2*RIN*RT12*RT21 + C1*C2*RB*RT12*RT21 + C1*C3*R2*RT12*RT21
 + C1*C2*R2*RT12*RT21 + C1*C3*R1*RT12*RT21 + C1*C2*R1*RT12*RT21
 + C1*C4*RL*RT11*RT21 + C1*CIN*RIN*RT11*RT21 + C1*C3*RIN*RT11*RT21
 + C1*C2*RIN*RT11*RT21 + C1*C2*RB*RT11*RT21 + C1*C3*R2*RT11*RT21
 + C1*C2*R2*RT11*RT21 + C1*C3*R1*RT11*RT21 + C1*C2*R1*RT11*RT21
 + C4*CIN*RIN*RL*RT21 + C3*C4*RIN*RL*RT21 + C2*C4*RIN*RL*RT21
 + C1*C4*RIN*RL*RT21 + C2*C4*RB*RL*RT21 + C1*C4*RB*RL*RT21 + C3*C4*R2*RL*RT21
 + C2*C4*R2*RL*RT21 + C1*C4*R2*RL*RT21 + C3*C4*R1*RL*RT21 + C2*C4*R1*RL*RT21
 + C2*CIN*RB*RIN*RT21 + C1*CIN*RB*RIN*RT21 + C2*C3*RB*RIN*RT21
 + C1*C3*RB*RIN*RT21 + C3*CIN*R2*RIN*RT21 + C2*CIN*R2*RIN*RT21
 + C1*CIN*R2*RIN*RT21 + C3*CIN*R1*RIN*RT21 + C2*CIN*R1*RIN*RT21
 + C1*C3*R1*RIN*RT21 + C1*C2*R1*RIN*RT21 + C2*C3*R2*RB*RT21 + C1*C3*R2*RB*RT21
 + C2*C3*R1*RB*RT21 + C1*C3*R1*RB*RT21 + C1*C2*R1*RB*RT21 + C1*C3*R1*R2*RT21
 + C1*C2*R1*R2*RT21 + C1*CIN*RIN*RL*RT12 + C1*C3*RIN*RL*RT12
 + C1*C2*RIN*RL*RT12 + C1*C4*RB*RL*RT12 + C1*C2*RB*RL*RT12 + C1*C4*R2*RL*RT12
 + C1*C3*R2*RL*RT12 + C1*C2*R2*RL*RT12 + C1*C3*R1*RL*RT12 + C1*C2*R1*RL*RT12
 + C1*CIN*RB*RIN*RT12 + C1*C3*RB*RIN*RT12 + C1*C2*RB*RIN*RT12
 + C1*CIN*R2*RIN*RT12 + C1*C3*R2*RIN*RT12 + C1*C2*R2*RIN*RT12
 + C1*C3*R2*RB*RT12 + C1*C3*R1*RB*RT12 + C1*C2*R1*RB*RT12 + C1*C3*R1*R2*RT12
 + C1*C2*R1*R2*RT12 + C1*CIN*RIN*RL*RT11 + C1*C3*RIN*RL*RT11
 + C1*C2*RIN*RL*RT11 + C1*C4*RB*RL*RT11 + C1*C2*RB*RL*RT11 + C1*C4*R2*RL*RT11
 + C1*C3*R2*RL*RT11 + C1*C2*R2*RL*RT11 + C1*C3*R1*RL*RT11 + C1*C2*R1*RL*RT11
 + C1*CIN*RB*RIN*RT11 + C1*C3*RB*RIN*RT11 + C1*C2*RB*RIN*RT11
 + C1*CIN*R2*RIN*RT11 + C1*C3*R2*RIN*RT11 + C1*C2*R2*RIN*RT11
 + C1*C3*R2*RB*RT11 + C1*C3*R1*RB*RT11 + C1*C2*R1*RB*RT11 + C1*C3*R1*R2*RT11
 + C1*C2*R1*R2*RT11 + C4*CIN*RB*RIN*RL + C2*CIN*RB*RIN*RL + C1*CIN*RB*RIN*RL
 + C3*C4*RB*RIN*RL + C2*C4*RB*RIN*RL + C1*C4*RB*RIN*RL + C2*C3*RB*RIN*RL
 + C1*C3*RB*RIN*RL + C4*CIN*R2*RIN*RL + C3*CIN*R2*RIN*RL + C2*CIN*R2*RIN*RL
 + C1*CIN*R2*RIN*RL + C3*C4*R2*RIN*RL + C2*C4*R2*RIN*RL + C1*C4*R2*RIN*RL
 + C3*CIN*R1*RIN*RL + C2*CIN*R1*RIN*RL + C1*C3*R1*RIN*RL + C1*C2*R1*RIN*RL
 + C3*C4*R2*RB*RL + C2*C3*R2*RB*RL + C1*C3*R2*RB*RL + C3*C4*R1*RB*RL
 + C2*C4*R1*RB*RL + C2*C3*R1*RB*RL + C1*C3*R1*RB*RL + C1*C2*R1*RB*RL
 + C3*C4*R1*R2*RL + C2*C4*R1*R2*RL + C1*C3*R1*R2*RL + C1*C2*R1*R2*RL
 + C3*CIN*R2*RB*RIN + C2*C3*R2*RB*RIN + C1*C3*R2*RB*RIN + C3*CIN*R1*RB*RIN
 + C2*CIN*R1*RB*RIN + C1*C3*R1*RB*RIN + C1*C2*R1*RB*RIN + C3*CIN*R1*R2*RIN
 + C2*CIN*R1*R2*RIN + C1*C3*R1*R2*RIN + C1*C2*R1*R2*RIN + C2*C3*R1*R2*RB;

var DEN_CIm = C4*RT21*RT22 + C4*RL*RT22 + C4*RB*RT22 + C4*R2*RT22 + C1*RT12*RT21
 + C1*RT11*RT21 + C4*RL*RT21 + CIN*RIN*RT21 + C3*RIN*RT21 + C2*RIN*RT21
 + C1*RIN*RT21 + C2*RB*RT21 + C1*RB*RT21 + C3*R2*RT21 + C2*R2*RT21 + C1*R2*RT21
 + C3*R1*RT21 + C2*R1*RT21 + C1*RL*RT12 + C1*RB*RT12 + C1*R2*RT12 + C1*RL*RT11
 + C1*RB*RT11 + C1*R2*RT11 + CIN*RIN*RL + C3*RIN*RL + C2*RIN*RL + C1*RIN*RL
 + C4*RB*RL + C2*RB*RL + C1*RB*RL + C4*R2*RL + C3*R2*RL + C2*R2*RL + C1*R2*RL
 + C3*R1*RL + C2*R1*RL + CIN*RB*RIN + C3*RB*RIN + C2*RB*RIN + C1*RB*RIN
 + CIN*R2*RIN + C3*R2*RIN + C2*R2*RIN + C1*R2*RIN + C3*R2*RB + C3*R1*RB
 + C2*R1*RB + C3*R1*R2 + C2*R1*R2;

var DEN_DRe = RT21 + RL + RB + R2;


var NOM_ZRe = 0
var NOM_YIm = C1*C2*C3*C4*CIN*R2*RB*RIN*RL*RT12*RT22
 + C1*C2*C3*C4*CIN*R2*RB*RIN*RL*RT11*RT22
 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RL*RT22;

var NOM_XRe = C1*C2*C4*CIN*RB*RIN*RL*RT12*RT22 + C1*C3*C4*CIN*R2*RIN*RL*RT12*RT22
 + C1*C2*C4*CIN*R2*RIN*RL*RT12*RT22 + C1*C2*C3*C4*R2*RB*RL*RT12*RT22
 + C1*C2*C4*CIN*RB*RIN*RL*RT11*RT22 + C1*C3*C4*CIN*R2*RIN*RL*RT11*RT22
 + C1*C2*C4*CIN*R2*RIN*RL*RT11*RT22 + C1*C2*C3*C4*R2*RB*RL*RT11*RT22
 + C2*C3*C4*CIN*R2*RB*RIN*RL*RT22 + C1*C3*C4*CIN*R2*RB*RIN*RL*RT22
 + C1*C3*C4*CIN*R1*RB*RIN*RL*RT22 + C1*C2*C4*CIN*R1*RB*RIN*RL*RT22
 + C1*C3*C4*CIN*R1*R2*RIN*RL*RT22 + C1*C2*C4*CIN*R1*R2*RIN*RL*RT22
 + C1*C2*C3*C4*R1*R2*RB*RL*RT22 + C1*C2*C3*CIN*R2*RB*RIN*RL*RT12
 + C1*C2*C3*CIN*R2*RB*RIN*RL*RT11 + C1*C2*C3*CIN*R1*R2*RB*RIN*RL;

var NOM_AIm = C1*C2*C4*RB*RL*RT12*RT22 + C1*C3*C4*R2*RL*RT12*RT22
 + C1*C2*C4*R2*RL*RT12*RT22 + C1*C2*C4*RB*RL*RT11*RT22
 + C1*C3*C4*R2*RL*RT11*RT22 + C1*C2*C4*R2*RL*RT11*RT22
 + C2*C4*CIN*RB*RIN*RL*RT22 + C1*C4*CIN*RB*RIN*RL*RT22
 + C3*C4*CIN*R2*RIN*RL*RT22 + C2*C4*CIN*R2*RIN*RL*RT22
 + C1*C4*CIN*R2*RIN*RL*RT22 + C2*C3*C4*R2*RB*RL*RT22 + C1*C3*C4*R2*RB*RL*RT22
 + C1*C3*C4*R1*RB*RL*RT22 + C1*C2*C4*R1*RB*RL*RT22 + C1*C3*C4*R1*R2*RL*RT22
 + C1*C2*C4*R1*R2*RL*RT22 + C1*C2*CIN*RB*RIN*RL*RT12 + C1*C3*CIN*R2*RIN*RL*RT12
 + C1*C2*CIN*R2*RIN*RL*RT12 + C1*C2*C3*R2*RB*RL*RT12 + C1*C2*CIN*RB*RIN*RL*RT11
 + C1*C3*CIN*R2*RIN*RL*RT11 + C1*C2*CIN*R2*RIN*RL*RT11 + C1*C2*C3*R2*RB*RL*RT11
 + C2*C3*CIN*R2*RB*RIN*RL + C1*C3*CIN*R2*RB*RIN*RL + C1*C3*CIN*R1*RB*RIN*RL
 + C1*C2*CIN*R1*RB*RIN*RL + C1*C3*CIN*R1*R2*RIN*RL + C1*C2*CIN*R1*R2*RIN*RL
 + C1*C2*C3*R1*R2*RB*RL;

var NOM_BRe = C2*C4*RB*RL*RT22 + C1*C4*RB*RL*RT22 + C3*C4*R2*RL*RT22
 + C2*C4*R2*RL*RT22 + C1*C4*R2*RL*RT22 + C1*C2*RB*RL*RT12 + C1*C3*R2*RL*RT12
 + C1*C2*R2*RL*RT12 + C1*C2*RB*RL*RT11 + C1*C3*R2*RL*RT11 + C1*C2*R2*RL*RT11
 + C2*CIN*RB*RIN*RL + C1*CIN*RB*RIN*RL + C3*CIN*R2*RIN*RL + C2*CIN*R2*RIN*RL
 + C1*CIN*R2*RIN*RL + C2*C3*R2*RB*RL + C1*C3*R2*RB*RL + C1*C3*R1*RB*RL
 + C1*C2*R1*RB*RL + C1*C3*R1*R2*RL + C1*C2*R1*R2*RL;

var NOM_CIm = C2*RB*RL + C1*RB*RL + C3*R2*RL + C2*R2*RL + C1*R2*RL;

var NOM_DRe = 0;

} else {

var DEN_ZRe = 0
var DEN_YIm = C1*C2*C3*C4*CIN*R2*RB*RIN*RT11*RT12*RT22
 + C1*C2*C3*C4*CIN*R1*RB*RIN*RT11*RT12*RT22
 + C1*C2*C3*C4*CIN*R2*RB*RIN*RL*RT12*RT22
 + C1*C2*C3*C4*CIN*R1*RB*RIN*RL*RT12*RT22
 + C1*C2*C3*C4*CIN*R2*RB*RIN*RL*RT11*RT22
 + C1*C2*C3*C4*CIN*R1*RB*RIN*RL*RT11*RT22
 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RT11*RT22
 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RL*RT22
 + C1*C2*C3*C4*CIN*R2*RB*RIN*RT11*RT12*RT21
 + C1*C2*C3*C4*CIN*R1*RB*RIN*RT11*RT12*RT21
 + C1*C2*C3*C4*CIN*R2*RB*RIN*RL*RT12*RT21
 + C1*C2*C3*C4*CIN*R1*RB*RIN*RL*RT12*RT21
 + C1*C2*C3*C4*CIN*R2*RB*RIN*RL*RT11*RT21
 + C1*C2*C3*C4*CIN*R1*RB*RIN*RL*RT11*RT21
 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RT11*RT21
 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RL*RT21
 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RT11*RT12
 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RL*RT12 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RL*RT11;


var DEN_XRe = C1*C2*C4*CIN*RB*RIN*RT11*RT12*RT22 + C1*C2*C3*C4*RB*RIN*RT11*RT12*RT22
 + C1*C3*C4*CIN*R2*RIN*RT11*RT12*RT22 + C1*C2*C4*CIN*R2*RIN*RT11*RT12*RT22
 + C1*C3*C4*CIN*R1*RIN*RT11*RT12*RT22 + C1*C2*C4*CIN*R1*RIN*RT11*RT12*RT22
 + C1*C2*C3*C4*R2*RB*RT11*RT12*RT22 + C1*C2*C3*C4*R1*RB*RT11*RT12*RT22
 + C1*C2*C4*CIN*RB*RIN*RL*RT12*RT22 + C1*C2*C3*C4*RB*RIN*RL*RT12*RT22
 + C1*C3*C4*CIN*R2*RIN*RL*RT12*RT22 + C1*C2*C4*CIN*R2*RIN*RL*RT12*RT22
 + C1*C3*C4*CIN*R1*RIN*RL*RT12*RT22 + C1*C2*C4*CIN*R1*RIN*RL*RT12*RT22
 + C1*C2*C3*C4*R2*RB*RL*RT12*RT22 + C1*C2*C3*C4*R1*RB*RL*RT12*RT22
 + C2*C3*C4*CIN*R2*RB*RIN*RT12*RT22 + C1*C2*C3*C4*R2*RB*RIN*RT12*RT22
 + C2*C3*C4*CIN*R1*RB*RIN*RT12*RT22 + C1*C2*C3*C4*R1*RB*RIN*RT12*RT22
 + C1*C2*C4*CIN*RB*RIN*RL*RT11*RT22 + C1*C2*C3*C4*RB*RIN*RL*RT11*RT22
 + C1*C3*C4*CIN*R2*RIN*RL*RT11*RT22 + C1*C2*C4*CIN*R2*RIN*RL*RT11*RT22
 + C1*C3*C4*CIN*R1*RIN*RL*RT11*RT22 + C1*C2*C4*CIN*R1*RIN*RL*RT11*RT22
 + C1*C2*C3*C4*R2*RB*RL*RT11*RT22 + C1*C2*C3*C4*R1*RB*RL*RT11*RT22
 + C1*C3*C4*CIN*R2*RB*RIN*RT11*RT22 + C1*C2*C3*C4*R2*RB*RIN*RT11*RT22
 + C1*C3*C4*CIN*R1*RB*RIN*RT11*RT22 + C1*C2*C4*CIN*R1*RB*RIN*RT11*RT22
 + C1*C3*C4*CIN*R1*R2*RIN*RT11*RT22 + C1*C2*C4*CIN*R1*R2*RIN*RT11*RT22
 + C1*C2*C3*C4*R1*R2*RB*RT11*RT22 + C2*C3*C4*CIN*R2*RB*RIN*RL*RT22
 + C1*C3*C4*CIN*R2*RB*RIN*RL*RT22 + C2*C3*C4*CIN*R1*RB*RIN*RL*RT22
 + C1*C3*C4*CIN*R1*RB*RIN*RL*RT22 + C1*C2*C4*CIN*R1*RB*RIN*RL*RT22
 + C1*C2*C3*C4*R1*RB*RIN*RL*RT22 + C1*C3*C4*CIN*R1*R2*RIN*RL*RT22
 + C1*C2*C4*CIN*R1*R2*RIN*RL*RT22 + C1*C2*C3*C4*R1*R2*RB*RL*RT22
 + C2*C3*C4*CIN*R1*R2*RB*RIN*RT22 + C1*C2*C3*C4*R1*R2*RB*RIN*RT22
 + C1*C2*C4*CIN*RB*RIN*RT11*RT12*RT21 + C1*C2*C3*C4*RB*RIN*RT11*RT12*RT21
 + C1*C3*C4*CIN*R2*RIN*RT11*RT12*RT21 + C1*C2*C4*CIN*R2*RIN*RT11*RT12*RT21
 + C1*C3*C4*CIN*R1*RIN*RT11*RT12*RT21 + C1*C2*C4*CIN*R1*RIN*RT11*RT12*RT21
 + C1*C2*C3*C4*R2*RB*RT11*RT12*RT21 + C1*C2*C3*C4*R1*RB*RT11*RT12*RT21
 + C1*C2*C4*CIN*RB*RIN*RL*RT12*RT21 + C1*C2*C3*C4*RB*RIN*RL*RT12*RT21
 + C1*C3*C4*CIN*R2*RIN*RL*RT12*RT21 + C1*C2*C4*CIN*R2*RIN*RL*RT12*RT21
 + C1*C3*C4*CIN*R1*RIN*RL*RT12*RT21 + C1*C2*C4*CIN*R1*RIN*RL*RT12*RT21
 + C1*C2*C3*C4*R2*RB*RL*RT12*RT21 + C1*C2*C3*C4*R1*RB*RL*RT12*RT21
 + C2*C3*C4*CIN*R2*RB*RIN*RT12*RT21 + C1*C2*C3*C4*R2*RB*RIN*RT12*RT21
 + C2*C3*C4*CIN*R1*RB*RIN*RT12*RT21 + C1*C2*C3*C4*R1*RB*RIN*RT12*RT21
 + C1*C2*C4*CIN*RB*RIN*RL*RT11*RT21 + C1*C2*C3*C4*RB*RIN*RL*RT11*RT21
 + C1*C3*C4*CIN*R2*RIN*RL*RT11*RT21 + C1*C2*C4*CIN*R2*RIN*RL*RT11*RT21
 + C1*C3*C4*CIN*R1*RIN*RL*RT11*RT21 + C1*C2*C4*CIN*R1*RIN*RL*RT11*RT21
 + C1*C2*C3*C4*R2*RB*RL*RT11*RT21 + C1*C2*C3*C4*R1*RB*RL*RT11*RT21
 + C1*C3*C4*CIN*R2*RB*RIN*RT11*RT21 + C1*C2*C3*C4*R2*RB*RIN*RT11*RT21
 + C1*C3*C4*CIN*R1*RB*RIN*RT11*RT21 + C1*C2*C4*CIN*R1*RB*RIN*RT11*RT21
 + C1*C3*C4*CIN*R1*R2*RIN*RT11*RT21 + C1*C2*C4*CIN*R1*R2*RIN*RT11*RT21
 + C1*C2*C3*C4*R1*R2*RB*RT11*RT21 + C2*C3*C4*CIN*R2*RB*RIN*RL*RT21
 + C1*C3*C4*CIN*R2*RB*RIN*RL*RT21 + C2*C3*C4*CIN*R1*RB*RIN*RL*RT21
 + C1*C3*C4*CIN*R1*RB*RIN*RL*RT21 + C1*C2*C4*CIN*R1*RB*RIN*RL*RT21
 + C1*C2*C3*C4*R1*RB*RIN*RL*RT21 + C1*C3*C4*CIN*R1*R2*RIN*RL*RT21
 + C1*C2*C4*CIN*R1*R2*RIN*RL*RT21 + C1*C2*C3*C4*R1*R2*RB*RL*RT21
 + C2*C3*C4*CIN*R1*R2*RB*RIN*RT21 + C1*C2*C3*C4*R1*R2*RB*RIN*RT21
 + C1*C3*C4*CIN*R2*RB*RIN*RT11*RT12 + C1*C2*C3*CIN*R2*RB*RIN*RT11*RT12
 + C1*C2*C3*C4*R2*RB*RIN*RT11*RT12 + C1*C3*C4*CIN*R1*RB*RIN*RT11*RT12
 + C1*C2*C4*CIN*R1*RB*RIN*RT11*RT12 + C1*C2*C3*CIN*R1*RB*RIN*RT11*RT12
 + C1*C3*C4*CIN*R1*R2*RIN*RT11*RT12 + C1*C2*C4*CIN*R1*R2*RIN*RT11*RT12
 + C1*C2*C3*C4*R1*R2*RB*RT11*RT12 + C1*C3*C4*CIN*R2*RB*RIN*RL*RT12
 + C1*C2*C3*CIN*R2*RB*RIN*RL*RT12 + C1*C2*C3*C4*R2*RB*RIN*RL*RT12
 + C1*C3*C4*CIN*R1*RB*RIN*RL*RT12 + C1*C2*C4*CIN*R1*RB*RIN*RL*RT12
 + C1*C2*C3*CIN*R1*RB*RIN*RL*RT12 + C1*C3*C4*CIN*R1*R2*RIN*RL*RT12
 + C1*C2*C4*CIN*R1*R2*RIN*RL*RT12 + C1*C2*C3*C4*R1*R2*RB*RL*RT12
 + C2*C3*C4*CIN*R1*R2*RB*RIN*RT12 + C1*C2*C3*C4*R1*R2*RB*RIN*RT12
 + C1*C3*C4*CIN*R2*RB*RIN*RL*RT11 + C1*C2*C3*CIN*R2*RB*RIN*RL*RT11
 + C1*C2*C3*C4*R2*RB*RIN*RL*RT11 + C1*C3*C4*CIN*R1*RB*RIN*RL*RT11
 + C1*C2*C4*CIN*R1*RB*RIN*RL*RT11 + C1*C2*C3*CIN*R1*RB*RIN*RL*RT11
 + C1*C3*C4*CIN*R1*R2*RIN*RL*RT11 + C1*C2*C4*CIN*R1*R2*RIN*RL*RT11
 + C1*C2*C3*C4*R1*R2*RB*RL*RT11 + C1*C2*C3*CIN*R1*R2*RB*RIN*RT11
 + C2*C3*C4*CIN*R1*R2*RB*RIN*RL + C1*C2*C3*CIN*R1*R2*RB*RIN*RL
 + C1*C2*C3*C4*R1*R2*RB*RIN*RL;


var DEN_AIm = C1*C4*CIN*RIN*RT11*RT12*RT22 + C1*C3*C4*RIN*RT11*RT12*RT22
 + C1*C2*C4*RIN*RT11*RT12*RT22 + C1*C2*C4*RB*RT11*RT12*RT22
 + C1*C3*C4*R2*RT11*RT12*RT22 + C1*C2*C4*R2*RT11*RT12*RT22
 + C1*C3*C4*R1*RT11*RT12*RT22 + C1*C2*C4*R1*RT11*RT12*RT22
 + C1*C4*CIN*RIN*RL*RT12*RT22 + C1*C3*C4*RIN*RL*RT12*RT22
 + C1*C2*C4*RIN*RL*RT12*RT22 + C1*C2*C4*RB*RL*RT12*RT22
 + C1*C3*C4*R2*RL*RT12*RT22 + C1*C2*C4*R2*RL*RT12*RT22
 + C1*C3*C4*R1*RL*RT12*RT22 + C1*C2*C4*R1*RL*RT12*RT22
 + C2*C4*CIN*RB*RIN*RT12*RT22 + C2*C3*C4*RB*RIN*RT12*RT22
 + C1*C2*C4*RB*RIN*RT12*RT22 + C3*C4*CIN*R2*RIN*RT12*RT22
 + C2*C4*CIN*R2*RIN*RT12*RT22 + C1*C3*C4*R2*RIN*RT12*RT22
 + C1*C2*C4*R2*RIN*RT12*RT22 + C3*C4*CIN*R1*RIN*RT12*RT22
 + C2*C4*CIN*R1*RIN*RT12*RT22 + C1*C3*C4*R1*RIN*RT12*RT22
 + C1*C2*C4*R1*RIN*RT12*RT22 + C2*C3*C4*R2*RB*RT12*RT22
 + C2*C3*C4*R1*RB*RT12*RT22 + C1*C4*CIN*RIN*RL*RT11*RT22
 + C1*C3*C4*RIN*RL*RT11*RT22 + C1*C2*C4*RIN*RL*RT11*RT22
 + C1*C2*C4*RB*RL*RT11*RT22 + C1*C3*C4*R2*RL*RT11*RT22
 + C1*C2*C4*R2*RL*RT11*RT22 + C1*C3*C4*R1*RL*RT11*RT22
 + C1*C2*C4*R1*RL*RT11*RT22 + C1*C4*CIN*RB*RIN*RT11*RT22
 + C1*C3*C4*RB*RIN*RT11*RT22 + C1*C2*C4*RB*RIN*RT11*RT22
 + C1*C4*CIN*R2*RIN*RT11*RT22 + C1*C3*C4*R2*RIN*RT11*RT22
 + C1*C2*C4*R2*RIN*RT11*RT22 + C1*C3*C4*R2*RB*RT11*RT22
 + C1*C3*C4*R1*RB*RT11*RT22 + C1*C2*C4*R1*RB*RT11*RT22
 + C1*C3*C4*R1*R2*RT11*RT22 + C1*C2*C4*R1*R2*RT11*RT22
 + C2*C4*CIN*RB*RIN*RL*RT22 + C1*C4*CIN*RB*RIN*RL*RT22
 + C2*C3*C4*RB*RIN*RL*RT22 + C1*C3*C4*RB*RIN*RL*RT22 + C3*C4*CIN*R2*RIN*RL*RT22
 + C2*C4*CIN*R2*RIN*RL*RT22 + C1*C4*CIN*R2*RIN*RL*RT22
 + C3*C4*CIN*R1*RIN*RL*RT22 + C2*C4*CIN*R1*RIN*RL*RT22
 + C1*C3*C4*R1*RIN*RL*RT22 + C1*C2*C4*R1*RIN*RL*RT22 + C2*C3*C4*R2*RB*RL*RT22
 + C1*C3*C4*R2*RB*RL*RT22 + C2*C3*C4*R1*RB*RL*RT22 + C1*C3*C4*R1*RB*RL*RT22
 + C1*C2*C4*R1*RB*RL*RT22 + C1*C3*C4*R1*R2*RL*RT22 + C1*C2*C4*R1*R2*RL*RT22
 + C3*C4*CIN*R2*RB*RIN*RT22 + C2*C3*C4*R2*RB*RIN*RT22 + C1*C3*C4*R2*RB*RIN*RT22
 + C3*C4*CIN*R1*RB*RIN*RT22 + C2*C4*CIN*R1*RB*RIN*RT22
 + C1*C3*C4*R1*RB*RIN*RT22 + C1*C2*C4*R1*RB*RIN*RT22 + C3*C4*CIN*R1*R2*RIN*RT22
 + C2*C4*CIN*R1*R2*RIN*RT22 + C1*C3*C4*R1*R2*RIN*RT22 + C1*C2*C4*R1*R2*RIN*RT22
 + C2*C3*C4*R1*R2*RB*RT22 + C1*C4*CIN*RIN*RT11*RT12*RT21
 + C1*C3*C4*RIN*RT11*RT12*RT21 + C1*C2*C4*RIN*RT11*RT12*RT21
 + C1*C2*C4*RB*RT11*RT12*RT21 + C1*C3*C4*R2*RT11*RT12*RT21
 + C1*C2*C4*R2*RT11*RT12*RT21 + C1*C3*C4*R1*RT11*RT12*RT21
 + C1*C2*C4*R1*RT11*RT12*RT21 + C1*C4*CIN*RIN*RL*RT12*RT21
 + C1*C3*C4*RIN*RL*RT12*RT21 + C1*C2*C4*RIN*RL*RT12*RT21
 + C1*C2*C4*RB*RL*RT12*RT21 + C1*C3*C4*R2*RL*RT12*RT21
 + C1*C2*C4*R2*RL*RT12*RT21 + C1*C3*C4*R1*RL*RT12*RT21
 + C1*C2*C4*R1*RL*RT12*RT21 + C2*C4*CIN*RB*RIN*RT12*RT21
 + C2*C3*C4*RB*RIN*RT12*RT21 + C1*C2*C4*RB*RIN*RT12*RT21
 + C3*C4*CIN*R2*RIN*RT12*RT21 + C2*C4*CIN*R2*RIN*RT12*RT21
 + C1*C3*C4*R2*RIN*RT12*RT21 + C1*C2*C4*R2*RIN*RT12*RT21
 + C3*C4*CIN*R1*RIN*RT12*RT21 + C2*C4*CIN*R1*RIN*RT12*RT21
 + C1*C3*C4*R1*RIN*RT12*RT21 + C1*C2*C4*R1*RIN*RT12*RT21
 + C2*C3*C4*R2*RB*RT12*RT21 + C2*C3*C4*R1*RB*RT12*RT21
 + C1*C4*CIN*RIN*RL*RT11*RT21 + C1*C3*C4*RIN*RL*RT11*RT21
 + C1*C2*C4*RIN*RL*RT11*RT21 + C1*C2*C4*RB*RL*RT11*RT21
 + C1*C3*C4*R2*RL*RT11*RT21 + C1*C2*C4*R2*RL*RT11*RT21
 + C1*C3*C4*R1*RL*RT11*RT21 + C1*C2*C4*R1*RL*RT11*RT21
 + C1*C4*CIN*RB*RIN*RT11*RT21 + C1*C3*C4*RB*RIN*RT11*RT21
 + C1*C2*C4*RB*RIN*RT11*RT21 + C1*C4*CIN*R2*RIN*RT11*RT21
 + C1*C3*C4*R2*RIN*RT11*RT21 + C1*C2*C4*R2*RIN*RT11*RT21
 + C1*C3*C4*R2*RB*RT11*RT21 + C1*C3*C4*R1*RB*RT11*RT21
 + C1*C2*C4*R1*RB*RT11*RT21 + C1*C3*C4*R1*R2*RT11*RT21
 + C1*C2*C4*R1*R2*RT11*RT21 + C2*C4*CIN*RB*RIN*RL*RT21
 + C1*C4*CIN*RB*RIN*RL*RT21 + C2*C3*C4*RB*RIN*RL*RT21 + C1*C3*C4*RB*RIN*RL*RT21
 + C3*C4*CIN*R2*RIN*RL*RT21 + C2*C4*CIN*R2*RIN*RL*RT21
 + C1*C4*CIN*R2*RIN*RL*RT21 + C3*C4*CIN*R1*RIN*RL*RT21
 + C2*C4*CIN*R1*RIN*RL*RT21 + C1*C3*C4*R1*RIN*RL*RT21 + C1*C2*C4*R1*RIN*RL*RT21
 + C2*C3*C4*R2*RB*RL*RT21 + C1*C3*C4*R2*RB*RL*RT21 + C2*C3*C4*R1*RB*RL*RT21
 + C1*C3*C4*R1*RB*RL*RT21 + C1*C2*C4*R1*RB*RL*RT21 + C1*C3*C4*R1*R2*RL*RT21
 + C1*C2*C4*R1*R2*RL*RT21 + C3*C4*CIN*R2*RB*RIN*RT21 + C2*C3*C4*R2*RB*RIN*RT21
 + C1*C3*C4*R2*RB*RIN*RT21 + C3*C4*CIN*R1*RB*RIN*RT21
 + C2*C4*CIN*R1*RB*RIN*RT21 + C1*C3*C4*R1*RB*RIN*RT21 + C1*C2*C4*R1*RB*RIN*RT21
 + C3*C4*CIN*R1*R2*RIN*RT21 + C2*C4*CIN*R1*R2*RIN*RT21
 + C1*C3*C4*R1*R2*RIN*RT21 + C1*C2*C4*R1*R2*RIN*RT21 + C2*C3*C4*R1*R2*RB*RT21
 + C1*C4*CIN*RB*RIN*RT11*RT12 + C1*C2*CIN*RB*RIN*RT11*RT12
 + C1*C3*C4*RB*RIN*RT11*RT12 + C1*C2*C4*RB*RIN*RT11*RT12
 + C1*C2*C3*RB*RIN*RT11*RT12 + C1*C4*CIN*R2*RIN*RT11*RT12
 + C1*C3*CIN*R2*RIN*RT11*RT12 + C1*C2*CIN*R2*RIN*RT11*RT12
 + C1*C3*C4*R2*RIN*RT11*RT12 + C1*C2*C4*R2*RIN*RT11*RT12
 + C1*C3*CIN*R1*RIN*RT11*RT12 + C1*C2*CIN*R1*RIN*RT11*RT12
 + C1*C3*C4*R2*RB*RT11*RT12 + C1*C2*C3*R2*RB*RT11*RT12
 + C1*C3*C4*R1*RB*RT11*RT12 + C1*C2*C4*R1*RB*RT11*RT12
 + C1*C2*C3*R1*RB*RT11*RT12 + C1*C3*C4*R1*R2*RT11*RT12
 + C1*C2*C4*R1*R2*RT11*RT12 + C1*C4*CIN*RB*RIN*RL*RT12
 + C1*C2*CIN*RB*RIN*RL*RT12 + C1*C3*C4*RB*RIN*RL*RT12 + C1*C2*C4*RB*RIN*RL*RT12
 + C1*C2*C3*RB*RIN*RL*RT12 + C1*C4*CIN*R2*RIN*RL*RT12
 + C1*C3*CIN*R2*RIN*RL*RT12 + C1*C2*CIN*R2*RIN*RL*RT12
 + C1*C3*C4*R2*RIN*RL*RT12 + C1*C2*C4*R2*RIN*RL*RT12 + C1*C3*CIN*R1*RIN*RL*RT12
 + C1*C2*CIN*R1*RIN*RL*RT12 + C1*C3*C4*R2*RB*RL*RT12 + C1*C2*C3*R2*RB*RL*RT12
 + C1*C3*C4*R1*RB*RL*RT12 + C1*C2*C4*R1*RB*RL*RT12 + C1*C2*C3*R1*RB*RL*RT12
 + C1*C3*C4*R1*R2*RL*RT12 + C1*C2*C4*R1*R2*RL*RT12 + C3*C4*CIN*R2*RB*RIN*RT12
 + C2*C3*CIN*R2*RB*RIN*RT12 + C2*C3*C4*R2*RB*RIN*RT12 + C1*C3*C4*R2*RB*RIN*RT12
 + C1*C2*C3*R2*RB*RIN*RT12 + C3*C4*CIN*R1*RB*RIN*RT12
 + C2*C4*CIN*R1*RB*RIN*RT12 + C2*C3*CIN*R1*RB*RIN*RT12
 + C1*C3*C4*R1*RB*RIN*RT12 + C1*C2*C4*R1*RB*RIN*RT12 + C1*C2*C3*R1*RB*RIN*RT12
 + C3*C4*CIN*R1*R2*RIN*RT12 + C2*C4*CIN*R1*R2*RIN*RT12
 + C1*C3*C4*R1*R2*RIN*RT12 + C1*C2*C4*R1*R2*RIN*RT12 + C2*C3*C4*R1*R2*RB*RT12
 + C1*C4*CIN*RB*RIN*RL*RT11 + C1*C2*CIN*RB*RIN*RL*RT11
 + C1*C3*C4*RB*RIN*RL*RT11 + C1*C2*C4*RB*RIN*RL*RT11 + C1*C2*C3*RB*RIN*RL*RT11
 + C1*C4*CIN*R2*RIN*RL*RT11 + C1*C3*CIN*R2*RIN*RL*RT11
 + C1*C2*CIN*R2*RIN*RL*RT11 + C1*C3*C4*R2*RIN*RL*RT11 + C1*C2*C4*R2*RIN*RL*RT11
 + C1*C3*CIN*R1*RIN*RL*RT11 + C1*C2*CIN*R1*RIN*RL*RT11 + C1*C3*C4*R2*RB*RL*RT11
 + C1*C2*C3*R2*RB*RL*RT11 + C1*C3*C4*R1*RB*RL*RT11 + C1*C2*C4*R1*RB*RL*RT11
 + C1*C2*C3*R1*RB*RL*RT11 + C1*C3*C4*R1*R2*RL*RT11 + C1*C2*C4*R1*R2*RL*RT11
 + C1*C3*CIN*R2*RB*RIN*RT11 + C1*C2*C3*R2*RB*RIN*RT11
 + C1*C3*CIN*R1*RB*RIN*RT11 + C1*C2*CIN*R1*RB*RIN*RT11
 + C1*C3*CIN*R1*R2*RIN*RT11 + C1*C2*CIN*R1*R2*RIN*RT11 + C1*C2*C3*R1*R2*RB*RT11
 + C3*C4*CIN*R2*RB*RIN*RL + C2*C3*CIN*R2*RB*RIN*RL + C1*C3*CIN*R2*RB*RIN*RL
 + C2*C3*C4*R2*RB*RIN*RL + C1*C3*C4*R2*RB*RIN*RL + C3*C4*CIN*R1*RB*RIN*RL
 + C2*C4*CIN*R1*RB*RIN*RL + C2*C3*CIN*R1*RB*RIN*RL + C1*C3*CIN*R1*RB*RIN*RL
 + C1*C2*CIN*R1*RB*RIN*RL + C1*C3*C4*R1*RB*RIN*RL + C1*C2*C4*R1*RB*RIN*RL
 + C1*C2*C3*R1*RB*RIN*RL + C3*C4*CIN*R1*R2*RIN*RL + C2*C4*CIN*R1*R2*RIN*RL
 + C1*C3*CIN*R1*R2*RIN*RL + C1*C2*CIN*R1*R2*RIN*RL + C1*C3*C4*R1*R2*RIN*RL
 + C1*C2*C4*R1*R2*RIN*RL + C2*C3*C4*R1*R2*RB*RL + C1*C2*C3*R1*R2*RB*RL
 + C2*C3*CIN*R1*R2*RB*RIN + C1*C2*C3*R1*R2*RB*RIN;

var DEN_BRe = C1*C4*RT11*RT12*RT22 + C1*C4*RL*RT12*RT22 + C4*CIN*RIN*RT12*RT22
 + C3*C4*RIN*RT12*RT22 + C2*C4*RIN*RT12*RT22 + C1*C4*RIN*RT12*RT22
 + C2*C4*RB*RT12*RT22 + C3*C4*R2*RT12*RT22 + C2*C4*R2*RT12*RT22
 + C3*C4*R1*RT12*RT22 + C2*C4*R1*RT12*RT22 + C1*C4*RL*RT11*RT22
 + C1*C4*RB*RT11*RT22 + C1*C4*R2*RT11*RT22 + C4*CIN*RIN*RL*RT22
 + C3*C4*RIN*RL*RT22 + C2*C4*RIN*RL*RT22 + C1*C4*RIN*RL*RT22 + C2*C4*RB*RL*RT22
 + C1*C4*RB*RL*RT22 + C3*C4*R2*RL*RT22 + C2*C4*R2*RL*RT22 + C1*C4*R2*RL*RT22
 + C3*C4*R1*RL*RT22 + C2*C4*R1*RL*RT22 + C4*CIN*RB*RIN*RT22 + C3*C4*RB*RIN*RT22
 + C2*C4*RB*RIN*RT22 + C1*C4*RB*RIN*RT22 + C4*CIN*R2*RIN*RT22
 + C3*C4*R2*RIN*RT22 + C2*C4*R2*RIN*RT22 + C1*C4*R2*RIN*RT22 + C3*C4*R2*RB*RT22
 + C3*C4*R1*RB*RT22 + C2*C4*R1*RB*RT22 + C3*C4*R1*R2*RT22 + C2*C4*R1*R2*RT22
 + C1*C4*RT11*RT12*RT21 + C1*C4*RL*RT12*RT21 + C4*CIN*RIN*RT12*RT21
 + C3*C4*RIN*RT12*RT21 + C2*C4*RIN*RT12*RT21 + C1*C4*RIN*RT12*RT21
 + C2*C4*RB*RT12*RT21 + C3*C4*R2*RT12*RT21 + C2*C4*R2*RT12*RT21
 + C3*C4*R1*RT12*RT21 + C2*C4*R1*RT12*RT21 + C1*C4*RL*RT11*RT21
 + C1*C4*RB*RT11*RT21 + C1*C4*R2*RT11*RT21 + C4*CIN*RIN*RL*RT21
 + C3*C4*RIN*RL*RT21 + C2*C4*RIN*RL*RT21 + C1*C4*RIN*RL*RT21 + C2*C4*RB*RL*RT21
 + C1*C4*RB*RL*RT21 + C3*C4*R2*RL*RT21 + C2*C4*R2*RL*RT21 + C1*C4*R2*RL*RT21
 + C3*C4*R1*RL*RT21 + C2*C4*R1*RL*RT21 + C4*CIN*RB*RIN*RT21 + C3*C4*RB*RIN*RT21
 + C2*C4*RB*RIN*RT21 + C1*C4*RB*RIN*RT21 + C4*CIN*R2*RIN*RT21
 + C3*C4*R2*RIN*RT21 + C2*C4*R2*RIN*RT21 + C1*C4*R2*RIN*RT21 + C3*C4*R2*RB*RT21
 + C3*C4*R1*RB*RT21 + C2*C4*R1*RB*RT21 + C3*C4*R1*R2*RT21 + C2*C4*R1*R2*RT21
 + C1*CIN*RIN*RT11*RT12 + C1*C3*RIN*RT11*RT12 + C1*C2*RIN*RT11*RT12
 + C1*C4*RB*RT11*RT12 + C1*C2*RB*RT11*RT12 + C1*C4*R2*RT11*RT12
 + C1*C3*R2*RT11*RT12 + C1*C2*R2*RT11*RT12 + C1*C3*R1*RT11*RT12
 + C1*C2*R1*RT11*RT12 + C1*CIN*RIN*RL*RT12 + C1*C3*RIN*RL*RT12
 + C1*C2*RIN*RL*RT12 + C1*C4*RB*RL*RT12 + C1*C2*RB*RL*RT12 + C1*C4*R2*RL*RT12
 + C1*C3*R2*RL*RT12 + C1*C2*R2*RL*RT12 + C1*C3*R1*RL*RT12 + C1*C2*R1*RL*RT12
 + C4*CIN*RB*RIN*RT12 + C2*CIN*RB*RIN*RT12 + C3*C4*RB*RIN*RT12
 + C2*C4*RB*RIN*RT12 + C1*C4*RB*RIN*RT12 + C2*C3*RB*RIN*RT12
 + C1*C2*RB*RIN*RT12 + C4*CIN*R2*RIN*RT12 + C3*CIN*R2*RIN*RT12
 + C2*CIN*R2*RIN*RT12 + C3*C4*R2*RIN*RT12 + C2*C4*R2*RIN*RT12
 + C1*C4*R2*RIN*RT12 + C1*C3*R2*RIN*RT12 + C1*C2*R2*RIN*RT12
 + C3*CIN*R1*RIN*RT12 + C2*CIN*R1*RIN*RT12 + C1*C3*R1*RIN*RT12
 + C1*C2*R1*RIN*RT12 + C3*C4*R2*RB*RT12 + C2*C3*R2*RB*RT12 + C3*C4*R1*RB*RT12
 + C2*C4*R1*RB*RT12 + C2*C3*R1*RB*RT12 + C3*C4*R1*R2*RT12 + C2*C4*R1*R2*RT12
 + C1*CIN*RIN*RL*RT11 + C1*C3*RIN*RL*RT11 + C1*C2*RIN*RL*RT11
 + C1*C4*RB*RL*RT11 + C1*C2*RB*RL*RT11 + C1*C4*R2*RL*RT11 + C1*C3*R2*RL*RT11
 + C1*C2*R2*RL*RT11 + C1*C3*R1*RL*RT11 + C1*C2*R1*RL*RT11 + C1*CIN*RB*RIN*RT11
 + C1*C3*RB*RIN*RT11 + C1*C2*RB*RIN*RT11 + C1*CIN*R2*RIN*RT11
 + C1*C3*R2*RIN*RT11 + C1*C2*R2*RIN*RT11 + C1*C3*R2*RB*RT11 + C1*C3*R1*RB*RT11
 + C1*C2*R1*RB*RT11 + C1*C3*R1*R2*RT11 + C1*C2*R1*R2*RT11 + C4*CIN*RB*RIN*RL
 + C2*CIN*RB*RIN*RL + C1*CIN*RB*RIN*RL + C3*C4*RB*RIN*RL + C2*C4*RB*RIN*RL
 + C1*C4*RB*RIN*RL + C2*C3*RB*RIN*RL + C1*C3*RB*RIN*RL + C4*CIN*R2*RIN*RL
 + C3*CIN*R2*RIN*RL + C2*CIN*R2*RIN*RL + C1*CIN*R2*RIN*RL + C3*C4*R2*RIN*RL
 + C2*C4*R2*RIN*RL + C1*C4*R2*RIN*RL + C3*CIN*R1*RIN*RL + C2*CIN*R1*RIN*RL
 + C1*C3*R1*RIN*RL + C1*C2*R1*RIN*RL + C3*C4*R2*RB*RL + C2*C3*R2*RB*RL
 + C1*C3*R2*RB*RL + C3*C4*R1*RB*RL + C2*C4*R1*RB*RL + C2*C3*R1*RB*RL
 + C1*C3*R1*RB*RL + C1*C2*R1*RB*RL + C3*C4*R1*R2*RL + C2*C4*R1*R2*RL
 + C1*C3*R1*R2*RL + C1*C2*R1*R2*RL + C3*CIN*R2*RB*RIN + C2*C3*R2*RB*RIN
 + C1*C3*R2*RB*RIN + C3*CIN*R1*RB*RIN + C2*CIN*R1*RB*RIN + C1*C3*R1*RB*RIN
 + C1*C2*R1*RB*RIN + C3*CIN*R1*R2*RIN + C2*CIN*R1*R2*RIN + C1*C3*R1*R2*RIN
 + C1*C2*R1*R2*RIN + C2*C3*R1*R2*RB;

var DEN_CIm = C4*RT12*RT22 + C4*RL*RT22 + C4*RB*RT22 + C4*R2*RT22 + C4*RT12*RT21
 + C4*RL*RT21 + C4*RB*RT21 + C4*R2*RT21 + C1*RT11*RT12 + C1*RL*RT12
 + CIN*RIN*RT12 + C3*RIN*RT12 + C2*RIN*RT12 + C1*RIN*RT12 + C4*RB*RT12
 + C2*RB*RT12 + C4*R2*RT12 + C3*R2*RT12 + C2*R2*RT12 + C3*R1*RT12 + C2*R1*RT12
 + C1*RL*RT11 + C1*RB*RT11 + C1*R2*RT11 + CIN*RIN*RL + C3*RIN*RL + C2*RIN*RL
 + C1*RIN*RL + C4*RB*RL + C2*RB*RL + C1*RB*RL + C4*R2*RL + C3*R2*RL + C2*R2*RL
 + C1*R2*RL + C3*R1*RL + C2*R1*RL + CIN*RB*RIN + C3*RB*RIN + C2*RB*RIN
 + C1*RB*RIN + CIN*R2*RIN + C3*R2*RIN + C2*R2*RIN + C1*R2*RIN + C3*R2*RB
 + C3*R1*RB + C2*R1*RB + C3*R1*R2 + C2*R1*R2;

var DEN_DRe = RT12 + RL + RB + R2;


var NOM_ZRe = 0
var NOM_YIm = C1*C2*C3*C4*CIN*R2*RB*RIN*RL*RT12*RT22
 + C1*C2*C3*C4*CIN*R1*RB*RIN*RL*RT12*RT22
 + C1*C2*C3*C4*CIN*R2*RB*RIN*RL*RT11*RT22
 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RL*RT22
 + C1*C2*C3*C4*CIN*R2*RB*RIN*RL*RT12*RT21
 + C1*C2*C3*C4*CIN*R1*RB*RIN*RL*RT12*RT21
 + C1*C2*C3*C4*CIN*R2*RB*RIN*RL*RT11*RT21
 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RL*RT21 + C1*C2*C3*C4*CIN*R1*R2*RB*RIN*RL*RT12;

var NOM_XRe = C1*C2*C4*CIN*RB*RIN*RL*RT12*RT22 + C1*C3*C4*CIN*R2*RIN*RL*RT12*RT22
 + C1*C2*C4*CIN*R2*RIN*RL*RT12*RT22 + C1*C3*C4*CIN*R1*RIN*RL*RT12*RT22
 + C1*C2*C4*CIN*R1*RIN*RL*RT12*RT22 + C1*C2*C3*C4*R2*RB*RL*RT12*RT22
 + C1*C2*C3*C4*R1*RB*RL*RT12*RT22 + C1*C2*C4*CIN*RB*RIN*RL*RT11*RT22
 + C1*C3*C4*CIN*R2*RIN*RL*RT11*RT22 + C1*C2*C4*CIN*R2*RIN*RL*RT11*RT22
 + C1*C2*C3*C4*R2*RB*RL*RT11*RT22 + C2*C3*C4*CIN*R2*RB*RIN*RL*RT22
 + C1*C3*C4*CIN*R2*RB*RIN*RL*RT22 + C1*C3*C4*CIN*R1*RB*RIN*RL*RT22
 + C1*C2*C4*CIN*R1*RB*RIN*RL*RT22 + C1*C3*C4*CIN*R1*R2*RIN*RL*RT22
 + C1*C2*C4*CIN*R1*R2*RIN*RL*RT22 + C1*C2*C3*C4*R1*R2*RB*RL*RT22
 + C1*C2*C4*CIN*RB*RIN*RL*RT12*RT21 + C1*C3*C4*CIN*R2*RIN*RL*RT12*RT21
 + C1*C2*C4*CIN*R2*RIN*RL*RT12*RT21 + C1*C3*C4*CIN*R1*RIN*RL*RT12*RT21
 + C1*C2*C4*CIN*R1*RIN*RL*RT12*RT21 + C1*C2*C3*C4*R2*RB*RL*RT12*RT21
 + C1*C2*C3*C4*R1*RB*RL*RT12*RT21 + C1*C2*C4*CIN*RB*RIN*RL*RT11*RT21
 + C1*C3*C4*CIN*R2*RIN*RL*RT11*RT21 + C1*C2*C4*CIN*R2*RIN*RL*RT11*RT21
 + C1*C2*C3*C4*R2*RB*RL*RT11*RT21 + C2*C3*C4*CIN*R2*RB*RIN*RL*RT21
 + C1*C3*C4*CIN*R2*RB*RIN*RL*RT21 + C1*C3*C4*CIN*R1*RB*RIN*RL*RT21
 + C1*C2*C4*CIN*R1*RB*RIN*RL*RT21 + C1*C3*C4*CIN*R1*R2*RIN*RL*RT21
 + C1*C2*C4*CIN*R1*R2*RIN*RL*RT21 + C1*C2*C3*C4*R1*R2*RB*RL*RT21
 + C1*C3*C4*CIN*R2*RB*RIN*RL*RT12 + C1*C2*C3*CIN*R2*RB*RIN*RL*RT12
 + C1*C3*C4*CIN*R1*RB*RIN*RL*RT12 + C1*C2*C4*CIN*R1*RB*RIN*RL*RT12
 + C1*C2*C3*CIN*R1*RB*RIN*RL*RT12 + C1*C3*C4*CIN*R1*R2*RIN*RL*RT12
 + C1*C2*C4*CIN*R1*R2*RIN*RL*RT12 + C1*C2*C3*C4*R1*R2*RB*RL*RT12
 + C1*C2*C3*CIN*R2*RB*RIN*RL*RT11 + C1*C2*C3*CIN*R1*R2*RB*RIN*RL;

var NOM_AIm = C1*C4*CIN*RIN*RL*RT12*RT22 + C1*C2*C4*RB*RL*RT12*RT22
 + C1*C3*C4*R2*RL*RT12*RT22 + C1*C2*C4*R2*RL*RT12*RT22
 + C1*C3*C4*R1*RL*RT12*RT22 + C1*C2*C4*R1*RL*RT12*RT22
 + C1*C2*C4*RB*RL*RT11*RT22 + C1*C3*C4*R2*RL*RT11*RT22
 + C1*C2*C4*R2*RL*RT11*RT22 + C2*C4*CIN*RB*RIN*RL*RT22
 + C1*C4*CIN*RB*RIN*RL*RT22 + C3*C4*CIN*R2*RIN*RL*RT22
 + C2*C4*CIN*R2*RIN*RL*RT22 + C1*C4*CIN*R2*RIN*RL*RT22 + C2*C3*C4*R2*RB*RL*RT22
 + C1*C3*C4*R2*RB*RL*RT22 + C1*C3*C4*R1*RB*RL*RT22 + C1*C2*C4*R1*RB*RL*RT22
 + C1*C3*C4*R1*R2*RL*RT22 + C1*C2*C4*R1*R2*RL*RT22 + C1*C4*CIN*RIN*RL*RT12*RT21
 + C1*C2*C4*RB*RL*RT12*RT21 + C1*C3*C4*R2*RL*RT12*RT21
 + C1*C2*C4*R2*RL*RT12*RT21 + C1*C3*C4*R1*RL*RT12*RT21
 + C1*C2*C4*R1*RL*RT12*RT21 + C1*C2*C4*RB*RL*RT11*RT21
 + C1*C3*C4*R2*RL*RT11*RT21 + C1*C2*C4*R2*RL*RT11*RT21
 + C2*C4*CIN*RB*RIN*RL*RT21 + C1*C4*CIN*RB*RIN*RL*RT21
 + C3*C4*CIN*R2*RIN*RL*RT21 + C2*C4*CIN*R2*RIN*RL*RT21
 + C1*C4*CIN*R2*RIN*RL*RT21 + C2*C3*C4*R2*RB*RL*RT21 + C1*C3*C4*R2*RB*RL*RT21
 + C1*C3*C4*R1*RB*RL*RT21 + C1*C2*C4*R1*RB*RL*RT21 + C1*C3*C4*R1*R2*RL*RT21
 + C1*C2*C4*R1*R2*RL*RT21 + C1*C4*CIN*RB*RIN*RL*RT12 + C1*C2*CIN*RB*RIN*RL*RT12
 + C1*C4*CIN*R2*RIN*RL*RT12 + C1*C3*CIN*R2*RIN*RL*RT12
 + C1*C2*CIN*R2*RIN*RL*RT12 + C1*C3*CIN*R1*RIN*RL*RT12
 + C1*C2*CIN*R1*RIN*RL*RT12 + C1*C3*C4*R2*RB*RL*RT12 + C1*C2*C3*R2*RB*RL*RT12
 + C1*C3*C4*R1*RB*RL*RT12 + C1*C2*C4*R1*RB*RL*RT12 + C1*C2*C3*R1*RB*RL*RT12
 + C1*C3*C4*R1*R2*RL*RT12 + C1*C2*C4*R1*R2*RL*RT12 + C1*C2*CIN*RB*RIN*RL*RT11
 + C1*C3*CIN*R2*RIN*RL*RT11 + C1*C2*CIN*R2*RIN*RL*RT11 + C1*C2*C3*R2*RB*RL*RT11
 + C2*C3*CIN*R2*RB*RIN*RL + C1*C3*CIN*R2*RB*RIN*RL + C1*C3*CIN*R1*RB*RIN*RL
 + C1*C2*CIN*R1*RB*RIN*RL + C1*C3*CIN*R1*R2*RIN*RL + C1*C2*CIN*R1*R2*RIN*RL
 + C1*C2*C3*R1*R2*RB*RL;

var NOM_BRe = C1*C4*RL*RT12*RT22 + C2*C4*RB*RL*RT22 + C1*C4*RB*RL*RT22
 + C3*C4*R2*RL*RT22 + C2*C4*R2*RL*RT22 + C1*C4*R2*RL*RT22 + C1*C4*RL*RT12*RT21
 + C2*C4*RB*RL*RT21 + C1*C4*RB*RL*RT21 + C3*C4*R2*RL*RT21 + C2*C4*R2*RL*RT21
 + C1*C4*R2*RL*RT21 + C1*CIN*RIN*RL*RT12 + C1*C4*RB*RL*RT12 + C1*C2*RB*RL*RT12
 + C1*C4*R2*RL*RT12 + C1*C3*R2*RL*RT12 + C1*C2*R2*RL*RT12 + C1*C3*R1*RL*RT12
 + C1*C2*R1*RL*RT12 + C1*C2*RB*RL*RT11 + C1*C3*R2*RL*RT11 + C1*C2*R2*RL*RT11
 + C2*CIN*RB*RIN*RL + C1*CIN*RB*RIN*RL + C3*CIN*R2*RIN*RL + C2*CIN*R2*RIN*RL
 + C1*CIN*R2*RIN*RL + C2*C3*R2*RB*RL + C1*C3*R2*RB*RL + C1*C3*R1*RB*RL
 + C1*C2*R1*RB*RL + C1*C3*R1*R2*RL + C1*C2*R1*R2*RL;

var NOM_CIm = C1*RL*RT12 + C2*RB*RL + C1*RB*RL + C3*R2*RL + C2*R2*RL + C1*R2*RL

var NOM_DRe = 0;


}

        // loop through the selected frequency points and do calculation
        for (j = 0; j < X.length; j++) {
            // w = 2*pi*f
            var w = 2*Math.PI*X[j];

            var XDEN_ZRe = -w*w*w*w*w*w*DEN_ZRe;
            var XDEN_YIm =  w*w*w*w*w*DEN_YIm;
            var XDEN_XRe =  w*w*w*w*DEN_XRe;
            var XDEN_AIm = -w*w*w*DEN_AIm;
            var XDEN_BRe = -w*w*DEN_BRe;
            var XDEN_CIm =  w*DEN_CIm;
            var XDEN_DRe =  DEN_DRe;

            var DENOMINATOR = ( (XDEN_ZRe + XDEN_XRe + XDEN_BRe + XDEN_DRe)*(XDEN_ZRe + XDEN_XRe + XDEN_BRe + XDEN_DRe) + (XDEN_YIm + XDEN_AIm + XDEN_CIm)*(XDEN_YIm + XDEN_AIm + XDEN_CIm) );

            var XNOM_I_ZRe = -w*w*w*w*w*w*NOM_ZRe; 
            var XNOM_I_YIm =  w*w*w*w*w*NOM_YIm;
            var XNOM_I_XRe =  w*w*w*w*NOM_XRe;
            var XNOM_I_AIm = -w*w*w*NOM_AIm;
            var XNOM_I_BRe = -w*w*NOM_BRe;
            var XNOM_I_CIm =  w*NOM_CIm;
            var XNOM_I_DRe =  NOM_DRe;

            var NUMERATOR_Re = (XNOM_I_ZRe + XNOM_I_XRe + XNOM_I_BRe + XNOM_I_DRe)*(XDEN_ZRe + XDEN_XRe + XDEN_BRe + XDEN_DRe) + (XNOM_I_YIm + XNOM_I_AIm + XNOM_I_CIm)*(XDEN_YIm + XDEN_AIm + XDEN_CIm);
            var NUMERATOR_Im = (XDEN_ZRe + XDEN_XRe + XDEN_BRe + XDEN_DRe)*(XNOM_I_YIm + XNOM_I_AIm + XNOM_I_CIm) - (XNOM_I_ZRe + XNOM_I_XRe + XNOM_I_BRe + XNOM_I_DRe)*(XDEN_YIm + XDEN_AIm + XDEN_CIm);

            var voltage = Math.sqrt(NUMERATOR_Re*NUMERATOR_Re + NUMERATOR_Im*NUMERATOR_Im)/DENOMINATOR;

            row = [];
            row.push(X[j]);
            // add possible snapshot data from storage
            for (k = 1; k < series; k++) {
                row.push(storeData[j][k]);
            }
            row.push( 20*Math.log(voltage)/Math.log(10) );
            data.push(row);
        }

        if (!g) {
            g = createDyGraph(data, "Fender Brownface");
        } else {
            g.updateOptions({file: data, labels: labelArray, colors: colorArray});
        }
    }

</SCRIPT>
</FORM>
</BODY>
</HTML>
